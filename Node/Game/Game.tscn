[gd_scene load_steps=17 format=3 uid="uid://bhdsiv24l5m1b"]

[ext_resource type="Script" uid="uid://dmeggih4p2o84" path="res://Node/Game/Game.gd" id="1_6e2ot"]
[ext_resource type="Script" uid="uid://d8i4qk7qi425" path="res://Node/Game/BuildingHandler.gd" id="2_8v1kq"]
[ext_resource type="Script" uid="uid://c7esx0lbv3mvq" path="res://Node/Game/ArenaHandler.gd" id="2_g1w7o"]
[ext_resource type="Script" uid="uid://y170qrt6uq0m" path="res://Node/Game/PlayerActionMachine.gd" id="2_il3tl"]
[ext_resource type="Script" uid="uid://bbrfxb1no6kye" path="res://Node/Game/IaActionMachine.gd" id="3_7aoj4"]
[ext_resource type="Script" uid="uid://bdjkx32t0cint" path="res://Node/Game/EntityHandler.gd" id="3_8v1kq"]
[ext_resource type="Script" uid="uid://cbjdh6pkrtsw7" path="res://Node/Game/Cursor.gd" id="6_g1w7o"]
[ext_resource type="PackedScene" uid="uid://d2sc4mbovli68" path="res://Node/UI/GameUI.tscn" id="7_yq4x2"]
[ext_resource type="Texture2D" uid="uid://ig04wo0yma7" path="res://Ressources/Sprite/UI/MovementArea.png" id="8_mcxou"]
[ext_resource type="Script" uid="uid://dt1s7m33c2fs6" path="res://Node/Game/MovementArea.gd" id="9_5s4hk"]
[ext_resource type="Texture2D" uid="uid://bb7w44imokim2" path="res://Ressources/Sprite/UI/ArrowMovement.png" id="10_7aoj4"]
[ext_resource type="Script" uid="uid://jc2lvo8lf0kt" path="res://Node/Game/MovementArrow.gd" id="11_054nj"]

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_5s4hk"]
texture = ExtResource("8_mcxou")
texture_region_size = Vector2i(128, 128)
0:0/0 = 0
0:0/0/terrain_set = 0
0:0/0/terrain = 0
0:0/0/terrains_peering_bit/right_side = 0
0:0/0/terrains_peering_bit/bottom_right_corner = 0
0:0/0/terrains_peering_bit/bottom_side = 0
1:0/0 = 0
1:0/0/terrain_set = 0
1:0/0/terrain = 0
1:0/0/terrains_peering_bit/right_side = 0
1:0/0/terrains_peering_bit/bottom_right_corner = 0
1:0/0/terrains_peering_bit/bottom_side = 0
1:0/0/terrains_peering_bit/bottom_left_corner = 0
1:0/0/terrains_peering_bit/left_side = 0
2:0/0 = 0
2:0/0/terrain_set = 0
2:0/0/terrain = 0
2:0/0/terrains_peering_bit/bottom_side = 0
2:0/0/terrains_peering_bit/bottom_left_corner = 0
2:0/0/terrains_peering_bit/left_side = 0
3:0/0 = 0
3:0/0/terrain_set = 0
3:0/0/terrain = 0
3:0/0/terrains_peering_bit/bottom_side = 0
3:1/0 = 0
3:1/0/terrain_set = 0
3:1/0/terrain = 0
3:1/0/terrains_peering_bit/bottom_side = 0
3:1/0/terrains_peering_bit/top_side = 0
3:2/0 = 0
3:2/0/terrain_set = 0
3:2/0/terrain = 0
3:2/0/terrains_peering_bit/top_side = 0
2:2/0 = 0
2:2/0/terrain_set = 0
2:2/0/terrain = 0
2:2/0/terrains_peering_bit/left_side = 0
2:2/0/terrains_peering_bit/top_left_corner = 0
2:2/0/terrains_peering_bit/top_side = 0
1:1/0 = 0
1:1/0/terrain_set = 0
1:1/0/terrain = 0
1:1/0/terrains_peering_bit/right_side = 0
1:1/0/terrains_peering_bit/bottom_right_corner = 0
1:1/0/terrains_peering_bit/bottom_side = 0
1:1/0/terrains_peering_bit/bottom_left_corner = 0
1:1/0/terrains_peering_bit/left_side = 0
1:1/0/terrains_peering_bit/top_left_corner = 0
1:1/0/terrains_peering_bit/top_side = 0
1:1/0/terrains_peering_bit/top_right_corner = 0
0:1/0 = 0
0:1/0/terrain_set = 0
0:1/0/terrain = 0
0:1/0/terrains_peering_bit/right_side = 0
0:1/0/terrains_peering_bit/bottom_right_corner = 0
0:1/0/terrains_peering_bit/bottom_side = 0
0:1/0/terrains_peering_bit/top_side = 0
0:1/0/terrains_peering_bit/top_right_corner = 0
0:2/0 = 0
0:2/0/terrain_set = 0
0:2/0/terrain = 0
0:2/0/terrains_peering_bit/right_side = 0
0:2/0/terrains_peering_bit/top_side = 0
0:2/0/terrains_peering_bit/top_right_corner = 0
0:3/0 = 0
0:3/0/terrain_set = 0
0:3/0/terrain = 0
0:3/0/terrains_peering_bit/right_side = 0
1:3/0 = 0
1:3/0/terrain_set = 0
1:3/0/terrain = 0
1:3/0/terrains_peering_bit/right_side = 0
1:3/0/terrains_peering_bit/left_side = 0
2:3/0 = 0
2:3/0/terrain_set = 0
2:3/0/terrain = 0
2:3/0/terrains_peering_bit/left_side = 0
2:1/0 = 0
2:1/0/terrain_set = 0
2:1/0/terrain = 0
2:1/0/terrains_peering_bit/bottom_side = 0
2:1/0/terrains_peering_bit/bottom_left_corner = 0
2:1/0/terrains_peering_bit/left_side = 0
2:1/0/terrains_peering_bit/top_left_corner = 0
2:1/0/terrains_peering_bit/top_side = 0
1:2/0 = 0
1:2/0/terrain_set = 0
1:2/0/terrain = 0
1:2/0/terrains_peering_bit/right_side = 0
1:2/0/terrains_peering_bit/left_side = 0
1:2/0/terrains_peering_bit/top_left_corner = 0
1:2/0/terrains_peering_bit/top_side = 0
1:2/0/terrains_peering_bit/top_right_corner = 0
3:3/0 = 0
3:3/0/terrain_set = 0
3:3/0/terrain = 0
4:2/0 = 0
4:2/0/terrain_set = 0
4:2/0/terrain = 0
4:2/0/terrains_peering_bit/right_side = 0
4:2/0/terrains_peering_bit/bottom_side = 0
4:3/0 = 0
4:3/0/terrain_set = 0
4:3/0/terrain = 0
4:3/0/terrains_peering_bit/right_side = 0
4:3/0/terrains_peering_bit/top_side = 0
5:3/0 = 0
5:3/0/terrain_set = 0
5:3/0/terrain = 0
5:3/0/terrains_peering_bit/left_side = 0
5:3/0/terrains_peering_bit/top_side = 0
5:2/0 = 0
5:2/0/terrain_set = 0
5:2/0/terrain = 0
5:2/0/terrains_peering_bit/bottom_side = 0
5:2/0/terrains_peering_bit/left_side = 0
5:1/0 = 0
5:1/0/terrain_set = 0
5:1/0/terrain = 0
5:1/0/terrains_peering_bit/right_side = 0
5:1/0/terrains_peering_bit/bottom_right_corner = 0
5:1/0/terrains_peering_bit/bottom_side = 0
5:1/0/terrains_peering_bit/bottom_left_corner = 0
5:1/0/terrains_peering_bit/left_side = 0
5:1/0/terrains_peering_bit/top_side = 0
5:1/0/terrains_peering_bit/top_right_corner = 0
4:1/0 = 0
4:1/0/terrain_set = 0
4:1/0/terrain = 0
4:1/0/terrains_peering_bit/right_side = 0
4:1/0/terrains_peering_bit/bottom_right_corner = 0
4:1/0/terrains_peering_bit/bottom_side = 0
4:1/0/terrains_peering_bit/bottom_left_corner = 0
4:1/0/terrains_peering_bit/left_side = 0
4:1/0/terrains_peering_bit/top_left_corner = 0
4:1/0/terrains_peering_bit/top_side = 0
4:0/0 = 0
4:0/0/terrain_set = 0
4:0/0/terrain = 0
4:0/0/terrains_peering_bit/right_side = 0
4:0/0/terrains_peering_bit/bottom_side = 0
4:0/0/terrains_peering_bit/bottom_left_corner = 0
4:0/0/terrains_peering_bit/left_side = 0
4:0/0/terrains_peering_bit/top_left_corner = 0
4:0/0/terrains_peering_bit/top_side = 0
4:0/0/terrains_peering_bit/top_right_corner = 0
5:0/0 = 0
5:0/0/terrain_set = 0
5:0/0/terrain = 0
5:0/0/terrains_peering_bit/right_side = 0
5:0/0/terrains_peering_bit/bottom_right_corner = 0
5:0/0/terrains_peering_bit/bottom_side = 0
5:0/0/terrains_peering_bit/left_side = 0
5:0/0/terrains_peering_bit/top_left_corner = 0
5:0/0/terrains_peering_bit/top_side = 0
5:0/0/terrains_peering_bit/top_right_corner = 0
6:0/0 = 0
6:0/0/terrain_set = 0
6:0/0/terrain = 0
6:0/0/terrains_peering_bit/right_side = 0
6:0/0/terrains_peering_bit/bottom_side = 0
6:0/0/terrains_peering_bit/bottom_left_corner = 0
6:0/0/terrains_peering_bit/left_side = 0
6:0/0/terrains_peering_bit/top_left_corner = 0
6:0/0/terrains_peering_bit/top_side = 0
7:0/0 = 0
7:0/0/terrain_set = 0
7:0/0/terrain = 0
7:0/0/terrains_peering_bit/right_side = 0
7:0/0/terrains_peering_bit/bottom_side = 0
7:0/0/terrains_peering_bit/left_side = 0
7:0/0/terrains_peering_bit/top_left_corner = 0
7:0/0/terrains_peering_bit/top_side = 0
7:0/0/terrains_peering_bit/top_right_corner = 0
7:1/0 = 0
7:1/0/terrain_set = 0
7:1/0/terrain = 0
7:1/0/terrains_peering_bit/right_side = 0
7:1/0/terrains_peering_bit/bottom_right_corner = 0
7:1/0/terrains_peering_bit/bottom_side = 0
7:1/0/terrains_peering_bit/left_side = 0
7:1/0/terrains_peering_bit/top_side = 0
7:1/0/terrains_peering_bit/top_right_corner = 0
6:1/0 = 0
6:1/0/terrain_set = 0
6:1/0/terrain = 0
6:1/0/terrains_peering_bit/right_side = 0
6:1/0/terrains_peering_bit/bottom_right_corner = 0
6:1/0/terrains_peering_bit/bottom_side = 0
6:1/0/terrains_peering_bit/bottom_left_corner = 0
6:1/0/terrains_peering_bit/left_side = 0
6:1/0/terrains_peering_bit/top_side = 0
6:2/0 = 0
6:2/0/terrain_set = 0
6:2/0/terrain = 0
6:2/0/terrains_peering_bit/right_side = 0
6:2/0/terrains_peering_bit/bottom_side = 0
6:2/0/terrains_peering_bit/top_side = 0
6:2/0/terrains_peering_bit/top_right_corner = 0
7:2/0 = 0
7:2/0/terrain_set = 0
7:2/0/terrain = 0
7:2/0/terrains_peering_bit/right_side = 0
7:2/0/terrains_peering_bit/bottom_right_corner = 0
7:2/0/terrains_peering_bit/bottom_side = 0
7:2/0/terrains_peering_bit/left_side = 0
8:2/0 = 0
8:2/0/terrain_set = 0
8:2/0/terrain = 0
8:2/0/terrains_peering_bit/right_side = 0
8:2/0/terrains_peering_bit/bottom_side = 0
8:2/0/terrains_peering_bit/bottom_left_corner = 0
8:2/0/terrains_peering_bit/left_side = 0
9:2/0 = 0
9:2/0/terrain_set = 0
9:2/0/terrain = 0
9:2/0/terrains_peering_bit/bottom_side = 0
9:2/0/terrains_peering_bit/left_side = 0
9:2/0/terrains_peering_bit/top_left_corner = 0
9:2/0/terrains_peering_bit/top_side = 0
9:3/0 = 0
9:3/0/terrain_set = 0
9:3/0/terrain = 0
9:3/0/terrains_peering_bit/right_side = 0
9:3/0/terrains_peering_bit/left_side = 0
9:3/0/terrains_peering_bit/top_side = 0
9:3/0/terrains_peering_bit/top_right_corner = 0
8:3/0 = 0
8:3/0/terrain_set = 0
8:3/0/terrain = 0
8:3/0/terrains_peering_bit/right_side = 0
8:3/0/terrains_peering_bit/bottom_right_corner = 0
8:3/0/terrains_peering_bit/bottom_side = 0
8:3/0/terrains_peering_bit/top_side = 0
7:3/0 = 0
7:3/0/terrain_set = 0
7:3/0/terrain = 0
7:3/0/terrains_peering_bit/bottom_side = 0
7:3/0/terrains_peering_bit/bottom_left_corner = 0
7:3/0/terrains_peering_bit/left_side = 0
7:3/0/terrains_peering_bit/top_side = 0
6:3/0 = 0
6:3/0/terrain_set = 0
6:3/0/terrain = 0
6:3/0/terrains_peering_bit/right_side = 0
6:3/0/terrains_peering_bit/left_side = 0
6:3/0/terrains_peering_bit/top_left_corner = 0
6:3/0/terrains_peering_bit/top_side = 0
8:1/0 = 0
8:1/0/terrain_set = 0
8:1/0/terrain = 0
8:1/0/terrains_peering_bit/right_side = 0
8:1/0/terrains_peering_bit/bottom_side = 0
8:1/0/terrains_peering_bit/bottom_left_corner = 0
8:1/0/terrains_peering_bit/left_side = 0
8:1/0/terrains_peering_bit/top_side = 0
8:0/0 = 0
8:0/0/terrain_set = 0
8:0/0/terrain = 0
8:0/0/terrains_peering_bit/right_side = 0
8:0/0/terrains_peering_bit/bottom_side = 0
8:0/0/terrains_peering_bit/left_side = 0
8:0/0/terrains_peering_bit/top_left_corner = 0
8:0/0/terrains_peering_bit/top_side = 0
9:0/0 = 0
9:0/0/terrain_set = 0
9:0/0/terrain = 0
9:0/0/terrains_peering_bit/right_side = 0
9:0/0/terrains_peering_bit/bottom_side = 0
9:0/0/terrains_peering_bit/left_side = 0
9:0/0/terrains_peering_bit/top_side = 0
9:0/0/terrains_peering_bit/top_right_corner = 0
10:0/0 = 0
10:0/0/terrain_set = 0
10:0/0/terrain = 0
10:0/0/terrains_peering_bit/right_side = 0
10:0/0/terrains_peering_bit/bottom_side = 0
10:0/0/terrains_peering_bit/left_side = 0
10:0/0/terrains_peering_bit/top_side = 0
9:1/0 = 0
9:1/0/terrain_set = 0
9:1/0/terrain = 0
9:1/0/terrains_peering_bit/right_side = 0
9:1/0/terrains_peering_bit/bottom_right_corner = 0
9:1/0/terrains_peering_bit/bottom_side = 0
9:1/0/terrains_peering_bit/left_side = 0
9:1/0/terrains_peering_bit/top_side = 0

[sub_resource type="TileSet" id="TileSet_bjo0o"]
tile_size = Vector2i(128, 128)
terrain_set_0/mode = 0
terrain_set_0/terrain_0/name = "Terrain 0"
terrain_set_0/terrain_0/color = Color(0.451144, 0.367278, 0.282726, 1)
sources/0 = SubResource("TileSetAtlasSource_5s4hk")

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_y6d2w"]
texture = ExtResource("10_7aoj4")
texture_region_size = Vector2i(128, 128)
3:0/0 = 0
3:0/0/terrain_set = 0
3:0/0/terrain = 0
3:0/0/terrains_peering_bit/bottom_side = 0
1:1/0 = 0
1:1/0/terrain_set = 0
1:1/0/terrain = 0
1:1/0/terrains_peering_bit/right_side = 0
1:1/0/terrains_peering_bit/bottom_side = 0
2:1/0 = 0
2:1/0/terrain_set = 0
2:1/0/terrain = 0
2:1/0/terrains_peering_bit/bottom_side = 0
2:1/0/terrains_peering_bit/left_side = 0
3:1/0 = 0
3:1/0/terrain_set = 0
3:1/0/terrain = 0
3:1/0/terrains_peering_bit/bottom_side = 0
3:1/0/terrains_peering_bit/top_side = 0
1:2/0 = 0
1:2/0/terrain_set = 0
1:2/0/terrain = 0
1:2/0/terrains_peering_bit/right_side = 0
1:2/0/terrains_peering_bit/top_side = 0
2:2/0 = 0
2:2/0/terrain_set = 0
2:2/0/terrain = 0
2:2/0/terrains_peering_bit/left_side = 0
2:2/0/terrains_peering_bit/top_side = 0
3:2/0 = 0
3:2/0/terrain_set = 0
3:2/0/terrain = 0
3:2/0/terrains_peering_bit/top_side = 0
0:3/0 = 0
0:3/0/terrain_set = 0
0:3/0/terrain = 0
0:3/0/terrains_peering_bit/right_side = 0
1:3/0 = 0
1:3/0/terrain_set = 0
1:3/0/terrain = 0
1:3/0/terrains_peering_bit/right_side = 0
1:3/0/terrains_peering_bit/left_side = 0
2:3/0 = 0
2:3/0/terrain_set = 0
2:3/0/terrain = 0
2:3/0/terrains_peering_bit/left_side = 0
3:3/0 = 0
3:3/0/terrain_set = 0
3:3/0/terrain = 0

[sub_resource type="TileSet" id="TileSet_81hta"]
tile_size = Vector2i(128, 128)
terrain_set_0/mode = 2
terrain_set_0/terrain_0/name = "Terrain 0"
terrain_set_0/terrain_0/color = Color(0.5, 0.34375, 0.25, 1)
sources/0 = SubResource("TileSetAtlasSource_y6d2w")

[node name="Game" type="Node2D" node_paths=PackedStringArray("playerActionMachine", "iaActionMachine", "arenaHandler", "buildingHandler", "entityHandler", "gameUI", "cursor", "backgroundMusic")]
y_sort_enabled = true
script = ExtResource("1_6e2ot")
playerActionMachine = NodePath("PlayerActionMachine")
iaActionMachine = NodePath("IaActionMachine")
arenaHandler = NodePath("ArenaHandler")
buildingHandler = NodePath("BuildingHandler")
entityHandler = NodePath("EntityHandler")
gameUI = NodePath("GameUI")
cursor = NodePath("InteractiveUI/SelectCursor")
backgroundMusic = NodePath("BackgroundMusic")

[node name="PlayerActionMachine" type="Node" parent="." node_paths=PackedStringArray("arenaHandler", "buildingHandler", "entityHandler", "gameUI", "cursor", "movementArea", "movementArrow")]
script = ExtResource("2_il3tl")
arenaHandler = NodePath("../ArenaHandler")
buildingHandler = NodePath("../BuildingHandler")
entityHandler = NodePath("../EntityHandler")
gameUI = NodePath("../GameUI")
cursor = NodePath("../InteractiveUI/SelectCursor")
movementArea = NodePath("../InteractiveUI/MovementArea")
movementArrow = NodePath("../InteractiveUI/MovementArrow")

[node name="IaActionMachine" type="Node" parent="." node_paths=PackedStringArray("game", "arenaHandler", "buildingHandler", "entityHandler", "cursor")]
script = ExtResource("3_7aoj4")
game = NodePath("..")
arenaHandler = NodePath("../ArenaHandler")
buildingHandler = NodePath("../BuildingHandler")
entityHandler = NodePath("../EntityHandler")
cursor = NodePath("../InteractiveUI/SelectCursor")

[node name="ArenaHandler" type="Node2D" parent="." node_paths=PackedStringArray("entityHandler")]
y_sort_enabled = true
script = ExtResource("2_g1w7o")
entityHandler = NodePath("../EntityHandler")

[node name="BuildingHandler" type="Node2D" parent="." node_paths=PackedStringArray("arenaHandler", "entityHandler")]
y_sort_enabled = true
script = ExtResource("2_8v1kq")
arenaHandler = NodePath("../ArenaHandler")
entityHandler = NodePath("../EntityHandler")

[node name="Neutral" type="Node2D" parent="BuildingHandler"]
y_sort_enabled = true

[node name="Team0" type="Node2D" parent="BuildingHandler"]
y_sort_enabled = true

[node name="Team1" type="Node2D" parent="BuildingHandler"]
y_sort_enabled = true

[node name="EntityHandler" type="Node2D" parent="." node_paths=PackedStringArray("playerActionMachine", "gameUI", "arenaHandler", "buildingHandler", "cursor")]
y_sort_enabled = true
script = ExtResource("3_8v1kq")
playerActionMachine = NodePath("../PlayerActionMachine")
gameUI = NodePath("../GameUI")
arenaHandler = NodePath("../ArenaHandler")
buildingHandler = NodePath("../BuildingHandler")
cursor = NodePath("../InteractiveUI/SelectCursor")

[node name="Team0" type="Node2D" parent="EntityHandler"]
y_sort_enabled = true

[node name="Team1" type="Node2D" parent="EntityHandler"]
y_sort_enabled = true

[node name="InteractiveUI" type="Node2D" parent="."]

[node name="SelectCursor" type="Sprite2D" parent="InteractiveUI" node_paths=PackedStringArray("arenaHandler", "iaActionMachine")]
z_index = 3
texture_filter = 1
scale = Vector2(2, 2)
script = ExtResource("6_g1w7o")
arenaHandler = NodePath("../../ArenaHandler")
iaActionMachine = NodePath("../../IaActionMachine")

[node name="Camera" type="Camera2D" parent="InteractiveUI/SelectCursor"]
scale = Vector2(0.5, 0.5)
position_smoothing_enabled = true
position_smoothing_speed = 4.0

[node name="MovementArea" type="TileMapLayer" parent="InteractiveUI" node_paths=PackedStringArray("arenaHandler", "entityHandler")]
z_index = 3
scale = Vector2(0.5, 0.5)
tile_set = SubResource("TileSet_bjo0o")
script = ExtResource("9_5s4hk")
arenaHandler = NodePath("../../ArenaHandler")
entityHandler = NodePath("../../EntityHandler")

[node name="MovementArrow" type="TileMapLayer" parent="InteractiveUI" node_paths=PackedStringArray("arenaHandler", "entityHandler", "cursor", "movementArea")]
z_index = 3
scale = Vector2(0.5, 0.5)
tile_set = SubResource("TileSet_81hta")
script = ExtResource("11_054nj")
arenaHandler = NodePath("../../ArenaHandler")
entityHandler = NodePath("../../EntityHandler")
cursor = NodePath("../SelectCursor")
movementArea = NodePath("../MovementArea")

[node name="GameUI" parent="." node_paths=PackedStringArray("arenaHandler", "buildingHandler", "entityHandler") instance=ExtResource("7_yq4x2")]
arenaHandler = NodePath("../ArenaHandler")
buildingHandler = NodePath("../BuildingHandler")
entityHandler = NodePath("../EntityHandler")

[node name="BackgroundMusic" type="AudioStreamPlayer" parent="."]
volume_db = 0.1
autoplay = true

[connection signal="playerLost" from="BuildingHandler" to="." method="_on_building_handler_player_lost"]
[connection signal="attackAt" from="InteractiveUI/SelectCursor" to="PlayerActionMachine" method="_on_select_cursor_attack_at"]
[connection signal="followingEntityEndedMovement" from="InteractiveUI/SelectCursor" to="PlayerActionMachine" method="_on_select_cursor_following_entity_ended_movement"]
[connection signal="movedToNewTile" from="InteractiveUI/SelectCursor" to="PlayerActionMachine" method="_on_select_cursor_moved_to_new_tile"]
[connection signal="movedToNewTile" from="InteractiveUI/SelectCursor" to="GameUI" method="_on_cursor_moved_to_new_tile"]
[connection signal="buyUnit" from="GameUI" to="EntityHandler" method="_on_game_ui_buy_unit"]
[connection signal="endTurn" from="GameUI" to="." method="_on_game_ui_end_turn"]
[connection signal="finished" from="BackgroundMusic" to="." method="_on_background_music_finished"]
